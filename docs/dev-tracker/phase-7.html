<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 1: Foundation - TankerMade Dev Tracker</title>

    <!-- Preload resources -->
    <link rel="preload" href="shared.css" as="style">
    <link rel="preload" href="shared.js" as="script">

    <!-- Prevent FOUC -->
    <style>
        body {
            opacity: 0;
            transition: opacity 0.15s ease-in;
        }

            body.loaded {
                opacity: 1;
            }
    </style>

    <link rel="stylesheet" href="shared.css">
    <script src="shared.js" defer></script>
</head>
<body>
    <!-- Header and nav will be injected here by JavaScript -->
    <div id="header-nav-placeholder"></div>

    <main>
        <div class="container">
            <h1>Admin & Operations Phase</h1>
            
            <div class="phase-intro">
                <div class="phase-meta">
                    <div class="meta-item">
                        <span class="meta-label">Duration:</span>
                        <span class="meta-value">Week 15</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Total Tasks:</span>
                        <span class="meta-value" id="total-tasks">27</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Estimated Time:</span>
                        <span class="meta-value">30-40 hours</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Complexity:</span>
                        <span class="meta-value">High (Data Safety)</span>
                    </div>
                </div>
                
                <div class="phase-goal">
                    <strong>Goal:</strong> Data safety and admin tools for production
                </div>
                
                <p><strong>What you'll build:</strong> Complete export/import system, database backup tools, user management for admins, and data integrity checking. This ensures data safety and provides essential operational tools for running the app in production.</p>
            </div>

            <div class="controls">
                <button class="btn success" onclick="markAllComplete()">‚úì Mark All Complete</button>
                <button class="btn" onclick="markAllIncomplete()">‚óã Mark All Incomplete</button>
                <button class="btn" onclick="exportPhaseProgress()">üìÅ Export Progress</button>
                <button class="btn danger" onclick="resetPhaseProgress()">üîÑ Reset Phase</button>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Export/Import System</h2>
                    <div class="deliverable-progress" id="export-progress">0 / 12 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Data Export</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="design-export-format">
                            <div class="task-content">
                                <div class="task-title">Design export JSON format</div>
                                <div class="task-description">Define schema with version, timestamp, entities array, metadata</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-export-service">
                            <div class="task-content">
                                <div class="task-title">Create data export service</div>
                                <div class="task-description">IExportService with SerializeAllData(userId) method</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-entity-serialization">
                            <div class="task-content">
                                <div class="task-title">Implement entity serialization</div>
                                <div class="task-description">Serialize Projects, Patterns, Inventory, WorkSessions, UserStats, Achievements</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="handle-relationships">
                            <div class="task-content">
                                <div class="task-title">Handle entity relationships</div>
                                <div class="task-description">Include related data, maintain foreign key references in export</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-export-ui">
                            <div class="task-content">
                                <div class="task-title">Add export UI to settings</div>
                                <div class="task-description">Export button with progress indicator, download trigger</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-file-download">
                            <div class="task-content">
                                <div class="task-title">Implement file download</div>
                                <div class="task-description">Generate filename with timestamp, trigger browser download</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>
                    </div>

                    <div class="task-group">
                        <div class="task-group-title">Data Import</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-import-service">
                            <div class="task-content">
                                <div class="task-title">Create data import service</div>
                                <div class="task-description">IImportService with DeserializeData and conflict resolution</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-merge-strategy">
                            <div class="task-content">
                                <div class="task-title">Implement merge vs replace strategies</div>
                                <div class="task-description">Replace: clear all data first. Merge: preserve existing, add new</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-import-preview">
                            <div class="task-content">
                                <div class="task-title">Create import preview UI</div>
                                <div class="task-description">Show what will be created/updated/deleted before applying</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="validate-import-data">
                            <div class="task-content">
                                <div class="task-title">Add import validation</div>
                                <div class="task-description">Validate JSON format, required fields, foreign key integrity</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="handle-import-errors">
                            <div class="task-content">
                                <div class="task-title">Handle import errors gracefully</div>
                                <div class="task-description">Transaction rollback, detailed error messages, partial success handling</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="test-export-import-roundtrip">
                            <div class="task-content">
                                <div class="task-title">Test export/import roundtrip</div>
                                <div class="task-description">Export data, clear database, import, verify everything matches</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Database Operations</h2>
                    <div class="deliverable-progress" id="database-progress">0 / 7 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Database Backup</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-sqlite-backup">
                            <div class="task-content">
                                <div class="task-title">Implement SQLite database backup</div>
                                <div class="task-description">Copy .db file with timestamp, handle file locking</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-postgres-backup">
                            <div class="task-content">
                                <div class="task-title">Implement PostgreSQL backup (server mode)</div>
                                <div class="task-description">pg_dump command execution, SQL file generation</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-backup-api-endpoint">
                            <div class="task-content">
                                <div class="task-title">Add backup API endpoint</div>
                                <div class="task-description">Admin-only GET /api/admin/backup endpoint with file download</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-backup-ui">
                            <div class="task-content">
                                <div class="task-title">Add backup UI to settings</div>
                                <div class="task-description">Admin-only section with backup button, backup history</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="schedule-automatic-backups">
                            <div class="task-content">
                                <div class="task-title">Add scheduled backup option</div>
                                <div class="task-description">Daily/weekly backup scheduling using background service</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>
                    </div>

                    <div class="task-group">
                        <div class="task-group-title">Database Maintenance</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-database-stats">
                            <div class="task-content">
                                <div class="task-title">Add database statistics</div>
                                <div class="task-description">Table row counts, database size, growth trends</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-database-cleanup">
                            <div class="task-content">
                                <div class="task-title">Add database cleanup tools</div>
                                <div class="task-description">Remove old sessions, compact database, orphaned record cleanup</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">User Management</h2>
                    <div class="deliverable-progress" id="users-progress">0 / 8 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Admin User Interface</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-admin-user-list">
                            <div class="task-content">
                                <div class="task-title">Create admin user list page</div>
                                <div class="task-description">Admin-only page showing all users with stats and actions</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-role-changes">
                            <div class="task-content">
                                <div class="task-title">Implement role changes</div>
                                <div class="task-description">Admin can change user roles: Viewer ‚Üí Editor ‚Üí Admin</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-user-deactivation">
                            <div class="task-content">
                                <div class="task-title">Add user deactivation</div>
                                <div class="task-description">Disable user login without deleting data</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-user-search-filter">
                            <div class="task-content">
                                <div class="task-title">Add user search and filtering</div>
                                <div class="task-description">Search by username/email, filter by role/status</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="show-user-statistics">
                            <div class="task-content">
                                <div class="task-title">Show user statistics</div>
                                <div class="task-description">Projects, time tracked, last login, account age per user</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>
                    </div>

                    <div class="task-group">
                        <div class="task-group-title">User Data Management</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-user-impersonation">
                            <div class="task-content">
                                <div class="task-title">Add user impersonation (admin)</div>
                                <div class="task-description">Admin can view app as any user for support purposes</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="export-user-data">
                            <div class="task-content">
                                <div class="task-title">Add per-user data export</div>
                                <div class="task-description">Admin can export specific user's data for support/GDPR</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="user-data-deletion">
                            <div class="task-content">
                                <div class="task-title">Add user data deletion</div>
                                <div class="task-description">Admin can permanently delete user and all their data</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="acceptance-criteria">
                <h3>‚úÖ Acceptance Criteria</h3>
                <ul class="criteria-list">
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="export-downloads-complete">
                        <div class="criteria-text">Export downloads complete JSON file with all user data</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="import-restores-data">
                        <div class="criteria-text">Import can restore from exported JSON successfully</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="import-preview-accurate">
                        <div class="criteria-text">Import preview shows accurate changes before applying</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="replace-clears-existing">
                        <div class="criteria-text">Replace option clears existing data completely</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="merge-preserves-data">
                        <div class="criteria-text">Merge option preserves existing data and adds new</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="backup-downloads-successfully">
                        <div class="criteria-text">Database backup downloads successfully in server mode</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="admin-manages-users">
                        <div class="criteria-text">Admin can manage user roles and deactivate users</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="data-integrity-reports">
                        <div class="criteria-text">Data integrity checker finds and reports issues</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="admin-only-features">
                        <div class="criteria-text">All admin features are properly restricted to admin role</div>
                    </li>
                </ul>
            </div>
        </div>
    </main>

        <script src="shared.js"></script>
    <script>
        initializePhaseTracker({
            phaseNumber: 7,
            phaseTitle: "Notes & Documentation",
            taskIds: [
                "create-notes-entities", "create-notes-dtos", "create-notes-services",
                "implement-notes-crud", "create-notes-editor", "add-notes-formatting",
                "implement-notes-templates", "create-notes-categories",
                "add-notes-tags", "implement-notes-search",
                "create-notes-linking", "add-notes-attachments",
                "implement-notes-versioning", "create-notes-collaboration",
                "add-notes-comments", "implement-notes-sharing",
                "create-notes-export", "add-notes-import",
                "implement-notes-sync", "create-offline-notes-service",
                "add-notes-encryption", "implement-notes-backup",
                "create-notes-restore", "add-notes-printing",
                "implement-notes-analytics", "create-notes-history",
                "add-notes-favorites", "implement-notes-archive"
            ],
            criteriaIds: [
                "notes-editor-functional", "notes-formatting-works", "notes-sync-reliable",
                "notes-linking-accurate", "notes-encryption-secure"
            ]
        });

    </script>
</body>
</html>
