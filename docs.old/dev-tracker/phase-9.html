<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 1: Foundation - TankerMade Dev Tracker</title>

    <!-- Preload resources -->
    <link rel="preload" href="shared.css" as="style">
    <link rel="preload" href="shared.js" as="script">

    <!-- Prevent FOUC -->
    <style>
        body {
            opacity: 0;
            transition: opacity 0.15s ease-in;
        }

            body.loaded {
                opacity: 1;
            }
    </style>

    <link rel="stylesheet" href="shared.css">
    <script src="shared.js" defer></script>
</head>
<body>
    <!-- Header and nav will be injected here by JavaScript -->
    <div id="header-nav-placeholder"></div>

    <main>
        <div class="container">
            <h1>Search & Performance Phase</h1>
            
            <div class="phase-intro">
                <div class="phase-meta">
                    <div class="meta-item">
                        <span class="meta-label">Duration:</span>
                        <span class="meta-value">Weeks 18-19</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Total Tasks:</span>
                        <span class="meta-value" id="total-tasks">28</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Estimated Time:</span>
                        <span class="meta-value">50-70 hours</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Complexity:</span>
                        <span class="meta-value">High (Performance)</span>
                    </div>
                </div>
                
                <div class="phase-goal">
                    <strong>Goal:</strong> Blazing fast search and scale to thousands of records
                </div>
                
                <p><strong>What you'll build:</strong> Global search functionality, server-side filtering with OData-style parameters, pagination on all lists, database indexing for performance, and intelligent caching. The app will remain responsive even with thousands of projects and inventory items.</p>
            </div>

            <div class="controls">
                <button class="btn success" onclick="markAllComplete()">‚úì Mark All Complete</button>
                <button class="btn" onclick="markAllIncomplete()">‚óã Mark All Incomplete</button>
                <button class="btn" onclick="exportPhaseProgress()">üìÅ Export Progress</button>
                <button class="btn danger" onclick="resetPhaseProgress()">üîÑ Reset Phase</button>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Search System</h2>
                    <div class="deliverable-progress" id="search-progress">0 / 10 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Global Search Infrastructure</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="design-search-architecture">
                            <div class="task-content">
                                <div class="task-title">Design search architecture</div>
                                <div class="task-description">Search across Projects, Patterns, Inventory with unified results, relevance scoring</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-search-service">
                            <div class="task-content">
                                <div class="task-title">Create search service interface</div>
                                <div class="task-description">ISearchService with SearchAsync(query, filters, pagination) method</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-fulltext-search-sqlite">
                            <div class="task-content">
                                <div class="task-title">Implement full-text search for SQLite</div>
                                <div class="task-description">Use SQLite FTS5 extension for full-text indexing and search</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-fulltext-search-postgres">
                            <div class="task-content">
                                <div class="task-title">Implement full-text search for PostgreSQL</div>
                                <div class="task-description">Use PostgreSQL's built-in full-text search with GIN indexes</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="fallback-like-search">
                            <div class="task-content">
                                <div class="task-title">Implement LIKE-based fallback search</div>
                                <div class="task-description">For databases without FTS, use optimized LIKE queries with indexes</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="offline-search-implementation">
                            <div class="task-content">
                                <div class="task-title">Implement client-side search for offline mode</div>
                                <div class="task-description">In-memory search with fuzzy matching, works with IndexedDB data</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>
                    </div>

                    <div class="task-group">
                        <div class="task-group-title">Search UI</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-global-search-bar">
                            <div class="task-content">
                                <div class="task-title">Create global search bar component</div>
                                <div class="task-description">Search bar in header with autocomplete, keyboard shortcuts (Ctrl+K)</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-search-autocomplete">
                            <div class="task-content">
                                <div class="task-title">Add search autocomplete</div>
                                <div class="task-description">Show suggestions while typing, recent searches, entity type icons</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-search-results-page">
                            <div class="task-content">
                                <div class="task-title">Create search results page</div>
                                <div class="task-description">Unified results view with entity type tabs, relevance sorting, result snippets</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-search-filters">
                            <div class="task-content">
                                <div class="task-title">Add search filters</div>
                                <div class="task-description">Filter by entity type, date range, theme, status with faceted search</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Server-Side Filtering & Pagination</h2>
                    <div class="deliverable-progress" id="filtering-progress">0 / 9 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">OData-Style Query Parameters</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="design-query-parameter-format">
                            <div class="task-content">
                                <div class="task-title">Design query parameter format</div>
                                <div class="task-description">$filter, $orderby, $top, $skip parameters like OData but simplified</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-query-parser">
                            <div class="task-content">
                                <div class="task-title">Implement query parameter parser</div>
                                <div class="task-description">Parse filter expressions: theme eq 'Amigurumi' and status eq 'Active'</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="build-dynamic-queries">
                            <div class="task-content">
                                <div class="task-title">Build dynamic LINQ queries</div>
                                <div class="task-description">Convert filter expressions to EF Core LINQ queries dynamically</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-sorting-support">
                            <div class="task-content">
                                <div class="task-title">Add dynamic sorting support</div>
                                <div class="task-description">Sort by any field: $orderby=name asc,createdAt desc</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="validate-query-parameters">
                            <div class="task-content">
                                <div class="task-title">Add query parameter validation</div>
                                <div class="task-description">Validate field names, operators, values; prevent SQL injection</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>

                    <div class="task-group">
                        <div class="task-group-title">Pagination Implementation</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-cursor-pagination">
                            <div class="task-content">
                                <div class="task-title">Implement cursor-based pagination</div>
                                <div class="task-description">More efficient than offset for large datasets, use ID-based cursors</div>
                            </div>
                            <div class="task-complexity complexity-hard">Hard</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-offset-pagination-fallback">
                            <div class="task-content">
                                <div class="task-title">Add offset pagination fallback</div>
                                <div class="task-description">Traditional page/size pagination for simpler scenarios</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="update-api-endpoints">
                            <div class="task-content">
                                <div class="task-title">Update all API endpoints for pagination</div>
                                <div class="task-description">Return PagedResult<T> with data, totalCount, hasNext metadata</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-pagination-ui-component">
                            <div class="task-content">
                                <div class="task-title">Create pagination UI component</div>
                                <div class="task-description">Page numbers, prev/next, page size selector, infinite scroll option</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Database Optimization</h2>
                    <div class="deliverable-progress" id="database-progress">0 / 6 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Database Indexing</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="analyze-query-patterns">
                            <div class="task-content">
                                <div class="task-title">Analyze common query patterns</div>
                                <div class="task-description">Identify most frequent WHERE clauses, JOIN operations, ORDER BY fields</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-single-column-indexes">
                            <div class="task-content">
                                <div class="task-title">Create single-column indexes</div>
                                <div class="task-description">Index UserId, CreatedAt, UpdatedAt, Name, Slug on all major tables</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-composite-indexes">
                            <div class="task-content">
                                <div class="task-title">Create composite indexes</div>
                                <div class="task-description">Multi-column indexes: (UserId, CreatedAt), (UserId, IsArchived), (PatternId, UserId)</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-fulltext-indexes">
                            <div class="task-content">
                                <div class="task-title">Add full-text indexes</div>
                                <div class="task-description">FTS indexes on Name, Description fields for better search performance</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="optimize-foreign-key-indexes">
                            <div class="task-content">
                                <div class="task-title">Optimize foreign key indexes</div>
                                <div class="task-description">Ensure all FK columns have indexes, especially for JOIN operations</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="create-index-migration">
                            <div class="task-content">
                                <div class="task-title">Create index migration</div>
                                <div class="task-description">EF Core migration with all performance indexes, background creation for large tables</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="deliverable-section">
                <div class="deliverable-header">
                    <h2 class="deliverable-title">Caching System</h2>
                    <div class="deliverable-progress" id="caching-progress">0 / 3 tasks</div>
                </div>
                <div class="deliverable-content">
                    <div class="task-group">
                        <div class="task-group-title">Application Caching</div>
                        
                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-memory-cache">
                            <div class="task-content">
                                <div class="task-title">Implement in-memory caching</div>
                                <div class="task-description">Cache reference data (themes, colors, brands) with TTL and invalidation</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="add-user-stats-caching">
                            <div class="task-content">
                                <div class="task-title">Cache user statistics</div>
                                <div class="task-description">Cache calculated stats (total projects, XP, levels) with smart invalidation</div>
                            </div>
                            <div class="task-complexity complexity-medium">Medium</div>
                        </div>

                        <div class="task-item">
                            <input type="checkbox" class="task-checkbox" data-task="implement-cache-warming">
                            <div class="task-content">
                                <div class="task-title">Implement cache warming</div>
                                <div class="task-description">Pre-populate cache on startup with frequently accessed data</div>
                            </div>
                            <div class="task-complexity complexity-easy">Easy</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="acceptance-criteria">
                <h3>‚úÖ Acceptance Criteria</h3>
                <ul class="criteria-list">
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="search-returns-fast">
                        <div class="criteria-text">Search returns results in <500ms for 1000+ records</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="global-search-works">
                        <div class="criteria-text">Global search works across all major entities</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="autocomplete-responsive">
                        <div class="criteria-text">Search autocomplete is responsive and helpful</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="filters-work-correctly">
                        <div class="criteria-text">Filters work correctly with search queries</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="pagination-loads-quickly">
                        <div class="criteria-text">Pagination loads quickly (no full table scans)</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="large-datasets-responsive">
                        <div class="criteria-text">App remains responsive with 5000+ inventory items</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="reference-data-cached">
                        <div class="criteria-text">Reference data loads instantly after first fetch</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="offline-search-works">
                        <div class="criteria-text">Offline search works without server connection</div>
                    </li>
                    <li class="criteria-item">
                        <input type="checkbox" class="criteria-checkbox" data-criteria="no-n-plus-one-queries">
                        <div class="criteria-text">No N+1 query problems in list views</div>
                    </li>
                </ul>
            </div>
        </div>
    </main>

        <script src="shared.js"></script>
    <script>
        initializePhaseTracker({
            phaseNumber: 9,
            phaseTitle: "Reports & Analytics",
            taskIds: [
                "create-report-entities", "create-report-dtos", "create-report-services",
                "implement-report-generation", "create-report-templates", "add-report-scheduling",
                "implement-report-export", "create-analytics-dashboard",
                "add-analytics-widgets", "implement-custom-reports",
                "create-report-filters", "add-date-range-selection",
                "implement-data-aggregation", "create-chart-visualizations",
                "add-table-reports", "implement-report-sharing",
                "create-report-subscriptions", "add-report-automation",
                "implement-report-caching", "create-report-history",
                "add-report-favorites", "implement-report-compare",
                "create-analytics-insights", "add-trend-analysis",
                "implement-predictive-analytics", "create-report-testing",
                "add-report-validation", "implement-report-performance-optimization"
            ],
            criteriaIds: [
                "reports-generate-accurately", "analytics-dashboard-loads", "report-export-works",
                "custom-reports-flexible", "analytics-insights-meaningful"
            ]
        });

    </script>
</body>
</html>
